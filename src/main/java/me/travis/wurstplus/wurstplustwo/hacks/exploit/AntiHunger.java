package me.travis.wurstplus.wurstplustwo.hacks.exploit;

import net.minecraft.client.Minecraft;
import net.minecraft.network.play.client.CPacketEntityAction;
import net.minecraft.network.play.client.CPacketPlayer;

import static net.minecraft.network.play.client.CPacketEntityAction.Action.START_SPRINTING;
import static net.minecraft.network.play.client.CPacketEntityAction.Action.STOP_SPRINTING;

import me.travis.wurstplus.wurstplustwo.event.events.EventNetworkPacketEvent;
import me.travis.wurstplus.wurstplustwo.guiscreen.settings.WurstplusSetting;
import me.travis.wurstplus.wurstplustwo.hacks.WurstplusCategory;
import me.travis.wurstplus.wurstplustwo.hacks.WurstplusHack;
import me.zero.alpine.fork.listener.EventHandler;
import me.zero.alpine.fork.listener.Listener;

//salhack
public class AntiHunger extends WurstplusHack
{
    WurstplusSetting sprint = create("Sprint", "Sprint", false);
    WurstplusSetting ground = create("Ground", "Ground", true);

    public AntiHunger() {
		super(WurstplusCategory.WURSTPLUS_EXPLOIT);

		this.name        = "AntiHunger"; 
		this.tag         = "AntiHunger";
		this.description = "reduces hunger loss";
    }


    @EventHandler
    private Listener<EventNetworkPacketEvent> PacketEvent = new Listener<>(p_Event ->
    {
        if (p_Event.getPacket() instanceof CPacketPlayer && ground.get_value(true) && !mc.player.isElytraFlying())
        {
            final CPacketPlayer l_Packet = (CPacketPlayer) p_Event.getPacket();
            if (mc.player.fallDistance > 0 || mc.playerController.isHittingBlock)
            {
                l_Packet.onGround = true;
            }
            else
            {
                l_Packet.onGround = false;
            }
        }
        
        if (p_Event.getPacket() instanceof CPacketEntityAction && sprint.get_value(true))
        {
            final CPacketEntityAction l_Packet = (CPacketEntityAction) p_Event.getPacket();
            if (l_Packet.getAction() == START_SPRINTING || l_Packet.getAction() == STOP_SPRINTING)
            {
                p_Event.cancel();
            }
        }
    });

}