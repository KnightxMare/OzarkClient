package me.travis.wurstplus.wurstplustwo.hacks.exploit;

import me.travis.wurstplus.wurstplustwo.hacks.WurstplusCategory;
import me.travis.wurstplus.wurstplustwo.hacks.WurstplusHack;
import me.travis.wurstplus.wurstplustwo.event.events.EventNetworkPacketEvent;
import me.zero.alpine.fork.listener.EventHandler;
import me.zero.alpine.fork.listener.Listener;
import net.minecraft.network.play.client.CPacketPlayer;

//from walfram tho i saw it on crepy salhack
public class Ghost extends WurstplusHack {

    public Ghost() {
        super(WurstplusCategory.WURSTPLUS_EXPLOIT);

        this.name = "Ghost";
        this.tag = "Ghost";
        this.description = "stay alive after dying";
    }

    boolean bypassdeath;


	@Override
	public void update() {
       if (mc.world == null) {
           return;
       }

       if (mc.player.getHealth() == 0.0f) {
           mc.player.setHealth(20.0f);
           mc.player.isDead = false;
           bypassdeath = true;
           mc.displayGuiScreen(null);
           mc.player.setPositionAndUpdate(mc.player.posX, mc.player.posY, mc.player.posZ);
       }
    }

    @EventHandler
    private final Listener<EventNetworkPacketEvent> netWorkManagerListener = new Listener<>(p_Event -> {
        if (bypassdeath && p_Event.getPacket() instanceof CPacketPlayer) {
            p_Event.cancel();
        }
    });

    @Override
    protected void disable() {
        if (mc.player != null) {
            mc.player.respawnPlayer();
        }
        bypassdeath = false;
    }

}